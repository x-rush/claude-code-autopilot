---
description: 基于需求对齐结果执行任务，Claude Code自主管理状态更新
---

# /autopilot-execute
基于已确认的需求对齐结果，按照执行计划继续执行任务，Claude Code自主管理所有状态文件的更新，确保与原始需求保持对齐。

## 🎯 执行约束

**严格遵循工作流程**：
- **基于需求对齐执行**：严格按照REQUIREMENT_ALIGNMENT.json中的用户需求和决策执行
- **遵循执行计划**：按照EXECUTION_PLAN.json中的任务顺序和验收标准执行
- **自主状态管理**：Claude Code自主更新所有状态文件，无需外部脚本
- **持续需求对齐**：执行过程中持续验证与原始需求的一致性
- **记录所有决策**：将偏离规划的决策详细记录到DECISION_LOG.json

## 📋 执行前检查

在开始执行前，我将自主检查：

### 1. 验证需求对齐文件
```javascript
// Claude Code内部处理流程
检查 REQUIREMENT_ALIGNMENT.json 是否存在并包含：
- 用户原始需求描述
- 已确认的技术方案和质量标准
- 用户偏好和约束条件
- 完整的交付物清单
```

### 2. 验证执行计划文件
```javascript
检查 EXECUTION_PLAN.json 是否存在并包含：
- 完整的TODO任务清单
- 任务依赖关系和执行顺序
- 每个任务的验收标准
- 质量门禁和安全边界
```

### 3. 验证状态文件完整性
```javascript
检查所有状态文件是否存在：
- TODO_TRACKER.json（任务进度跟踪）
- DECISION_LOG.json（决策记录）
- EXECUTION_STATE.json（执行状态）
```

### 4. 读取当前执行状态
```javascript
从状态文件读取：
- 当前执行位置和进度
- 已完成的任务和质量评分
- 最近的决策记录
- 系统健康状态
```

## 🚀 执行流程

### 1. 确定下一个任务
基于执行计划和当前状态，我将：

#### 读取执行计划
```javascript
// 从 EXECUTION_PLAN.json 获取任务信息
1. 读取 execution_todos 数组
2. 根据当前进度找到下一个待执行任务
3. 验证任务的前置依赖条件
4. 确认任务的安全边界约束
```

#### 评估任务状态
```javascript
// 从 TODO_TRACKER.json 评估进度
1. 检查已完成的任务和状态
2. 分析任务质量和错误历史
3. 确认当前执行的连续性
4. 识别需要恢复的异常状态
```

### 2. 执行任务
严格按照需求对齐和执行计划执行：

#### 遵循用户需求
- **符合原始目标**：确保执行结果符合REQUIREMENT_ALIGNMENT.json中的核心目标
- **满足质量标准**：达到用户确认的质量标准和验收条件
- **遵循技术方案**：按照已确认的技术选择和架构设计实现
- **尊重用户偏好**：按照用户偏好和风险容忍度执行

#### 满足验收标准
- **功能完整性**：确保功能实现符合规划要求
- **质量符合性**：达到设定的代码质量和测试标准
- **文档要求**：按照偏好的文档风格完善文档
- **性能指标**：满足性能和安全要求

#### 处理执行过程
- **依赖管理**：确保前置任务已完成且质量达标
- **错误处理**：按照预设的错误处理策略处理异常
- **决策记录**：记录偏离规划的决策和原因
- **质量检查**：执行自检点和质量门禁验证

### 3. 自主状态更新
任务完成后，我将立即自主更新所有状态文件：

#### 更新TODO_TRACKER.json
```javascript
// Claude Code自主更新任务进度
1. 标记当前任务状态为"completed"
2. 记录完成时间和实际执行时长
3. 更新进度百分比和质量评分
4. 记录验收标准的达成情况
5. 更新错误历史和重试次数
```

#### 更新EXECUTION_STATE.json
```javascript
// Claude Code自主更新执行状态
1. 更新当前执行位置到下一个任务
2. 记录最后活动时间和持续时间
3. 更新会话元数据和统计信息
4. 刷新系统资源和健康状态
5. 更新下一个任务的预估信息
```

#### 更新DECISION_LOG.json（如有偏离）
```javascript
// 记录执行过程中的重要决策
1. 记录决策的触发事件和上下文
2. 详细说明决策过程和选择理由
3. 评估决策对需求对齐的影响
4. 记录实施计划和预期结果
5. 跟踪决策实施的成功指标
```

### 4. 需求对齐验证
每完成任务后，我将自主验证：

#### 需求一致性检查
```javascript
// 验证执行结果与原始需求的一致性
1. 对比实现功能与用户原始目标
2. 检查技术方案与预设决策的一致性
3. 验证质量标准与用户期望的匹配度
4. 确认交付物与需求的符合程度
```

#### 质量标准验证
```javascript
// 评估执行结果的质量
1. 检查代码质量和结构规范
2. 验证功能实现的完整性和正确性
3. 确认测试覆盖和文档完善程度
4. 评估性能和安全标准的达成情况
```

#### 用户偏好符合性
```javascript
// 验证执行风格符合用户偏好
1. 检查代码风格和注释详细程度
2. 确认文档风格和技术深度
3. 验证创新程度和技术选择
4. 评估风险处理和错误处理方式
```

## 📊 执行状态报告

### 实时进度概览
- **已完成任务**：显示已完成的任务数量和质量
- **总任务数量**：显示计划中的总任务数
- **完成百分比**：实时计算的整体进度
- **当前任务**：显示正在执行的任务信息
- **预估剩余时间**：基于历史数据预估

### 质量指标状态
- **代码质量评分**：已完成任务的平均质量评分
- **需求对齐度**：与原始需求的一致性评估
- **决策一致性**：决策与需求对齐的匹配程度
- **执行效率**：基于实际时间vs预估时间的效率

### 系统健康状态
- **会话持续时间**：当前执行会话的运行时间
- **上下文健康度**：上下文窗口的健康状态评分
- **错误恢复率**：错误处理的成功率统计
- **资源利用率**：系统资源的使用情况

## 🔄 异常处理

### 状态文件异常
```javascript
// Claude Code自主处理状态文件问题
if (文件不存在或损坏) {
  1. 基于templates/中的结构定义重新生成文件
  2. 根据当前执行状态恢复数据
  3. 记录异常情况到DECISION_LOG.json
  4. 验证恢复后的数据完整性
}
```

### 任务执行异常
```javascript
// Claude Code自主处理执行失败
if (任务执行失败) {
  1. 分析失败原因和影响范围
  2. 查找执行计划中的恢复策略
  3. 尝试预设的重试和修复方案
  4. 更新错误状态到相关文件
  5. 如果需要，请求用户确认调整方案
}
```

### 需求对齐异常
```javascript
// Claude Code自主处理需求偏离
if (发现需求对齐问题) {
  1. 立即停止当前执行
  2. 分析偏离程度和影响范围
  3. 基于REQUIREMENT_ALIGNMENT.json寻找解决方案
  4. 记录偏离详情和调整建议
  5. 请求用户确认后继续执行
}
```

## ⚙️ 使用方法

### 继续自动执行
```bash
/autopilot-execute
```
我将自主：
1. 检查所有状态文件和需求对齐
2. 确定下一个待执行任务
3. 按照需求和计划执行任务
4. 自主更新所有状态文件
5. 验证需求对齐和质量标准
6. 准备下一个任务的执行

### 恢复中断执行
```bash
/autopilot-execute --recover
```
恢复中断的执行：
1. 检查中断原因和状态
2. 恢复到正确的执行位置
3. 修复损坏的状态文件
4. 继续正常执行流程

### 跳过指定任务
```bash
/autopilot-execute --skip <任务ID>
```
跳过指定任务：
1. 记录跳过原因和影响
2. 更新相关状态文件
3. 继续执行后续任务
4. 确保整体执行的连续性

### 验证执行状态
```bash
/autopilot-execute --status
```
显示当前执行状态：
1. 当前进度和任务信息
2. 质量评分和对齐状态
3. 系统健康和资源状态
4. 下一步执行建议

## 📝 注意事项

### 完全自主执行
- 所有状态文件更新都由Claude Code自主完成
- 不依赖任何外部脚本或工具
- 确保状态文件的数据一致性和完整性
- 严格按照工作流程约束执行

### 持续需求对齐
- 每个任务完成后自动验证需求对齐
- 发现偏离立即停止并分析原因
- 所有调整都基于原始需求对齐文件
- 保持与用户需求的持续一致性

### 完整决策记录
- 任何偏离规划的决策都详细记录
- 说明决策的原因和预期影响
- 评估决策对需求对齐的影响
- 确保决策过程的透明和可追溯

---

现在开始执行。我将自主检查当前状态，确定下一个任务，并严格按照需求对齐结果继续执行。