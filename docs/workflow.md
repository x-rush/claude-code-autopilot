# 工作流程详解

Claude Code AutoPilot 采用严格的三阶段工作流程，确保项目执行的质量和连续性。

## 工作流程约束
```
用户需求任务 → 深度讨论决策 → 生成需求对齐 → 制定执行计划 → Claude Code自主执行 → 持续状态更新 → 需求对齐验证
```

## 阶段1：需求深度讨论
**目标**：确保完全理解用户需求和所有决策点

### 讨论内容
- **核心目标确认**：最终成果、使用场景、成功标准
- **技术方案讨论**：架构设计、技术栈、实现细节
- **质量标准设定**：代码质量、测试策略、文档要求
- **用户偏好确认**：工作方式、风险容忍度、沟通偏好

### 产出物
- 详细的用户需求理解
- 确认的技术方案和决策
- 明确的质量标准和验收条件
- 用户偏好和约束条件

## 阶段2：执行计划生成
**目标**：基于需求讨论生成详细执行计划

### 计划内容
- **任务分解**：将需求分解为具体可执行任务
- **依赖关系**：确定任务间的依赖和执行顺序
- **验收标准**：为每个任务设定明确验收条件
- **质量门禁**：设定质量检查点和控制机制

### 状态文件初始化
生成5个核心JSON状态文件的运行时版本：
- 基于templates/结构定义
- 填充项目特定的需求和对齐信息
- 建立完整的跟踪和监控机制

## 阶段3：自主执行管理
**目标**：按计划连续执行并实时更新状态

### 执行特点
- **严格按计划执行**：遵循EXECUTION_PLAN.json中的任务顺序
- **自主状态更新**：Claude Code自动更新所有状态文件
- **持续需求对齐**：定期验证执行与需求的一致性
- **智能异常处理**：自动检测和恢复执行异常

### 状态管理
- **实时进度跟踪**：更新TODO_TRACKER.json
- **决策过程记录**：记录到DECISION_LOG.json
- **执行状态维护**：更新EXECUTION_STATE.json
- **需求对齐验证**：对照REQUIREMENT_ALIGNMENT.json

## 持续监控和恢复
**目标**：确保24小时连续执行的稳定性

### 监控机制
- **状态文件健康检查**：验证文件完整性和一致性
- **执行进度监控**：跟踪任务执行状态和质量
- **需求对齐检查**：持续验证与原始需求的一致性
- **系统健康评估**：监控整体执行健康度

### 恢复策略
- **轻微问题**：自动修复JSON格式和字段错误
- **中度问题**：重建部分损坏数据，从备份恢复
- **严重问题**：重新初始化状态文件，人工确认

## 工作流程优势
- **需求导向**：一切从用户具体需求出发
- **充分讨论**：确保所有重要决策经过充分讨论
- **动态生成**：基于讨论结果生成项目特定规划
- **自主执行**：Claude Code完全自主管理执行过程
- **持续对齐**：执行过程中持续验证需求一致性

## 违反工作流程的处理
如果检测到偏离工作流程：
1. 立即停止当前执行
2. 分析偏离原因和影响范围
3. 基于REQUIREMENT_ALIGNMENT.json寻找解决方案
4. 记录偏离详情和调整建议
5. 请求用户确认后继续执行

详细命令使用请参考：
- [命令参考](../commands/README.md)
- [状态管理](state-management.md)